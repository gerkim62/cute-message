<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <title>Create your message</title>
</head>

<body>

<script>
  function createSelectList(arr, id) {
  const select = document.createElement("select");
  select.classList.add("form-control");
  select.id = id;
  select.setAttribute('required','')
  
  // Create a default option
  const defaultOption = document.createElement("option");
  defaultOption.value = '';
  defaultOption.disabled = false;
  defaultOption.selected = false;
  defaultOption.textContent = "Click to Select";
  select.appendChild(defaultOption);
  
  // Create options for each item in the array
  for (let i = 0; i < arr.length; i++) {
    const option = document.createElement("option");
    option.value = i;
    option.textContent = arr[i];
    select.appendChild(option);
  }
  
  return select;
}

const messages = ["Happy birthday!fjfdjd djdidjfjgfii dididdidididi didsidiifgi dididfifici disdi", "Happy anniversary!", "Happy new year!", "Merry Christmas!", "Happy Independence Day!", "Happy Mashujaa Day!"];

const modal = `
<div class="modalfade" id="messageModal" tabindex="-1" role="dialog" aria-labelledby="messageModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="messageModalLabel">Create your Message!</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<form>
<div class="modal-body">
<div class="form-group">
<label for="senderName">Sender's Name</label>
<input required  type="text" class="form-control" id="senderName" placeholder="Enter your name">
</div>
<div class="form-group">
<label for="receiverName">Receiver's Name(optional)</label>
<input type="text" class="form-control" id="receiverName" placeholder="Enter the receiver's name">
</div>
<div class="form-group">
<label for="messageSelect">Select a Message</label>
${createSelectList(messages, 'messages').outerHTML}
</div>
<div class="form-group">
<label for="messageSelect">Select a Day</label>
${createSelectList(messages, 'days').outerHTML}
</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
<button type="submit" class="btn btn-primary">Create</button>
</div>
</form>
</div>
</div> </div>
`;

document.body.innerHTML += modal;
/*
const shareButton = document.getElementById("share-button");

shareButton.addEventListener("click", (event) => {
  if ("share" in navigator) {
    navigator
      .share({
        title: "Look at this native web share",
        url:
          "https://daily-dev-tips.com/posts/using-the-native-web-share-javascript-api/"
      })
      .then(() => {
        console.log("Callback after sharing");
      })
      .catch(console.error);
  } else {
    alert(`Sorry this browser doesn't have native share`)
  }
});
*/
function createAndShareLink(e){
  console.log(e)
  e.preventDefault()
  const messageIndexInput = Number(document.getElementById('messages').value)
  const eventIndexInput = Number(document.getElementById('days').value)
  const senderNameInput = document.getElementById('senderName').value
  const receiverNameInput = document.getElementById('receiverName').value
  console.log({messageIndexInput, eventIndexInput,senderNameInput,receiverNameInput})

  const url = location.origin+`?from=${senderNameInput}&to=${receiverNameInput}&ei=${eventIndexInput}&qi=${messageIndexInput}`
  console.log(url)
  document.getElementById('messageModal').innerHTML+= `<a class="btn btn-primary d-flex justify-content-center mt-3 mx-5" href="whatsapp://send?text=My beautiful surprise message for you: ${url}" data-action="share/whatsapp/share" target="_blank"> Share to WhatsApp </a>`
    if ("share" in navigator) {
    navigator
      .share({
        title: "Share with your friend",
        url
      })
      .then(() => {
        console.log("Callback after sharing");
      })
      .catch(console.error);
  } else {
    //alert(`Sorry this browser doesn't have native share`)
  }
}

document.querySelector('form').addEventListener('submit', createAndShareLink)



</script>
</body>

</html>